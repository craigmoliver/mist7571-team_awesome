<!DOCTYPE html>
<html>
<head>
	<title>Scaventure - the Adventure Awaits</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="assets/scaventure.min.css" />
    <link rel="stylesheet" href="assets/jquery.mobile.icons.min.css" />
    <link rel="stylesheet" href="assets/jquery.mobile.structure-1.4.2.min.css" />
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Seaweed+Script">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Abel">

    <script src="assets/jquery-1.11.1.min.js"></script>
    <script src="assets/jquery.mobile-1.4.2.min.js"></script>
    
    <script type="text/javascript">
 	// function to read storage and init form
    function checkStorage() {
        // check if local storage available
        if (window.localStorage) {
            var key, value, field;
            // loop through local storage
            for (var i = 0; i < localStorage.length; i++) {
                // retrieve the key
                key = localStorage.key(i);
                
                // set the field from the key
                field = document.getElementById(key);
                
                // check for field and assign value
                if (field) {
                    // retrieve the value
                    value = unescape(localStorage.getItem(key));
                    // set the field value
                    field.value = value; 
                }
            } // end for loop
        } // end local storage check 
    } // end function
    
    // set the localStorage with the changed field
    function updateStorage(elKey, elValue) {
        // check if local storage is available
        if (window.localStorage) {
            var key, value;
            
            // set key to form field id
            key = elKey;
            
            // set value to form field value
            value = elValue;
            
            // try to set item in local storage 
            try {
                localStorage.setItem(key, value);
                var savedVal = localStorage.getItem(key);
                console.log("Saved [" + key + "] into localStorage with the Value => " + savedVal);
            }
            catch (err) {
                //unable to set item in local storage
                if (err.code == QUOTA_EXCEEDED_ERR) {
                    alert('localStorage ran out of memory.'); }
                }
            } else {
                alert('localStorage is not supported.');
            } 
        }
    // initialize our form from local storage
    window.addEventListener('load',checkStorage,false);
    </script>
    
	<script type="text/javascript">
	//load the json object into the local storage
	$(window).load(function(){
		var json;
		console.log("This is a test2 ");
		
	    $.getJSON("assets/profileJSON.json", function(result) {
	    	console.log("This is a test 31");
	    	result = JSON.stringify(result);
            updateStorage('json', result);
	    	
          //retrieve json data from local storage
            json = JSON.parse(localStorage.getItem('json'));
          
			console.log("This is a name " + json.profile.username);
			console.log("This is a email " + json.profile.email);
			
            
                $("#username").html(json.profile.username.value);
                $("#email").html(json.profile.email);
                console.log("This is a email2 " + json.profile.email);
                $("#firstName").html(json.profile.firstName);
                $("#cities").html(json.profile.cities.length);
                $("#huntsComp").html(json.profile.cities.huntsComp.length);
                $("#cluesComp").html(json.profile.cities.cluesComp.length);
            
	    });

	});
 	
  	//Load user info from local storage
  	//function loadUser
  	//if new user or first vist show profile set up
  	
  	//tell them to push user info into user local storage array
  	
  	//loop to display profile contents
  	
    </script>
</head>
<body>

<div data-role="page">
    <!-- /header -->
    <div data-role="header">
        <a href="index.html" data-icon="home">Home</a>
        <h1>Scaventure</h1>
    </div>
    <br/>
    <div data-role="main" class="ui-content">
        <img src="assets/images/mustache.png" width="70" height="70" style="float: right; display: block;"></img>
    	<div data-role="content" data-inset="true">
                <h3>Welcome back,<div id="firstName" class="pirate"></div></h3>
                <div class="profileList" style="list-style-type: none;display:inline;" >
                
        		<div id="username"></div>
        		<div id="email"></div>
        		<br/>
        		<a href="#" ><div id="cities"></div> Cities Scavenged</a>
                <a href="#" ><div id="huntsComp"></div> Hunts Completed</a>
                <a href="#" ><div id="cluesComp"></div> Clues Solved</a>
                </div>
                
                <!-- Only seen when the user hasn't set up a profile -->
                <div>
                	<form>
                	<label for="username">First Name</label>
		            <input name="username" id="username" value="">
                	<label for="firstName">Username</label>
		            <input name="firstName" id="firstName" value="">
		            <label for="email">Email</label>
		            <input name="email" id="email" value="" type="email">
		            <label for="password">Password</label>
		            <input name="password" id="password" value="" autocomplete="off" type="password" />
		            <input value="Update" data-theme="a" type="button">
		        	</form>
                </div>
                <br><br>
                 
        </div>
    </div><!-- /content -->

    <div data-role="footer">
        <h4>2014 Scaventure - MIST 7571 | Team Awesome</h4>
    </div><!-- /footer -->

</div><!-- /page -->

</body>
</html>